{% extends 'base.html.twig' %}

{% block title %}Order validation
{% endblock %}
{% block body %}
	<div class="merde"></div>
	<div class="container ">
		<h1>Order validation</h1>
		{% for message in app.flashes('error') %}
			<div class="alert alert-danger">{{ message }}</div>
		{% endfor %}
		{% for message in app.flashes('success') %}
			<div class="alert alert-success">{{ message }}</div>
		{% endfor %}

		<table class="table border border-dark border-2">
			<thead class="">
				<th class="text-center border table-secondary">Order Nb:</th>
				<th colspan="3" class="text-center border table-secondary">{{order.reference}}</th>
				<tr>
					<th class="text-center border text-primary">Item</th>
					<th class="text-center border text-primary">Quantity</th>
					<th class="text-center border text-primary">Price</th>
					<th class="text-center border text-primary">total per item</th>
				</tr>
			</thead>
			<tbody>
				{% set total = 0 %}
				{% for detail in order.ordersDetails %}
					<tr>
						<td class="text-center border">{{ detail.item.name }}</td>
						<td class="text-center border">{{ detail.quantity }}
							pcs</td>
						<td class="text-center border">{{ detail.item.price }}
							$</td>
						<td class="text-center border">{{ detail.quantity * detail.item.price }}
							$</td>
					</tr>
					{% set total = total + (detail.quantity * detail.item.price) %}
				{% endfor %}
			</tbody>
			<tfoot>
				<tr>
					<td class="text-center border text-primary fw-bold">Total:</td>
					<td colspan="3" class="text-center border text-primary">{{ total }}
						$</td>
				</tr>
				<tr>
					<td class="text-center border fw-bold table-secondary">delivered to:</td>
					<td colspan="3" class="text-center borderd table-secondary">{{order.user.nom}}
						{{order.user.prenom}},
						{{order.adresse}},
						{{order.codePostal}}
						{{order.ville}}</td>
				</tr>
			</tfoot>
		</table>
		{{ form_start(form) }}
		<div class="d-flex justify-content-between">
			<div>
				<a href="{{path('cart_index')}}" class="btn btn-secondary my-4">Return to cart</a>
			</div>
			<div>
				<a href="{{path('app_orders_delete')}}" class="btn btn-danger my-4 mx-2">Delete the order</a>
				<button type="submit" class="btn btn-primary my-4">Validate the order</button>
			</div>
		</div>
		{{ form_end(form) }}
	</div>
{% endblock %}
